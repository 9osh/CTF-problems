# 题目描述

<!--试题是整体是一个什么功能，菜单题或管理系统需给出各功能简要描述--> 

game是一个可以游玩的推箱子游戏，具有任务移动，换皮肤，破墙等功能。

<!--菜单题或管理系统需给出各功能简要描述，没有菜单可将此处删除--> 
**操作说明**
1. 启动游戏
1. 退出程序
1. 退出游戏
1. 人物移动
6. 更换皮肤
6. 破坏墙体

注：标准库均不存在漏洞，有关动态内存申请的size大小均不存在漏洞

# 解题方式及漏洞说明

<!--解题方式、试题预置的漏洞个数和范围、同种漏洞个数存在的上限等--> 

**解题方式**：考生通过源码审计发现代码存在的漏洞，针对漏洞进行源码修复，修复完成后运行验证程序获取修复结果。

**漏洞说明**：试题总共预置5个漏洞点，均在大纲范围内，同一试题漏洞点不重复，每个漏洞点对应1个flag，共有5个flag。

**漏洞类型**：

二进制：敏感信息泄露、敏感信息使用完后未显示清除、缓冲区溢出、命令注入、格式化字符串问题、日志注入、循环条件受控、整数溢出/反转、不正确的数组索引、数据类型转换错误、差一错误、除0问题、空指针引用、双重释放内存、访问已经释放内存、未初始化变量/指针使用、资源泄露、内存泄露


# 源码修复及验证

<!--考生ssh账号/密码、源码资源路径、文件备份及源码修复方法、如何验证修复结果--> 

- 源码资源路径及相关权限说明
  - 源码路径为/home/sectest/challenge下，通常会有源码文件、readme文件、submit文件。
  - 考生以sectest权限进行源码审计与修补。
  - 考生只有权限编辑和覆盖（可覆盖是为了考生修复失败后进行环境代码恢复）源码文件和readme文件，无权复制新建其他文件。
  - submit验证程序考生只可运行，进行答案验证。
- 考生ssh账号/密码
  - 二进制：sectest/UWF9GN05yXSV
- 源码修复方法及注意事项
  - 考生需通过ssh连接试题环境进行源码修复，提供有vim、nano编辑器，修复完成后使用`wq!`退出。
    - 命令`ssh sectest@127.0.0.1 -p 22`
      - `-P 22`为端口可视情况修改、`127.0.0.1`为ip可视情况修改
  - **不允许修改源代码文件名称**，否则submit后会导致编译失败，浪费一次提交机会。
  - 注释也会算入行数，提交前，**先测试行数是否超过限制**。行数判断依据：`git diff --stat main.c main_fixed.c`
  - 考生修复完源码后，运行同目录下submit文件即可查看修复结果，如果修复成功可获得返回的flag;submit文件**只有20次运行机会**，一次可修复多个漏洞点，请考生谨慎提交运行。
  - 修复范围原则上**只允许修复关键漏洞位置**（如size大小、条件限制不严等），对于硬编码的用户名密码等其他和漏洞点无关的数据不允许修改，验证程序会对其进行检测；对于漏洞点无关的代码请不要修改和添加新代码；不能改变程序执行逻辑。
  - **除漏洞修复必须外，不能随意增加代码行数**，验证程序会其进行检测，每个试题环境中都有最大改动行数限制提示（查看环境readme.txt），请谨慎修改源码。
- 文件备份方法
  - 考生可自行备份原始代码文件到/tmp目录
    - 命令`cp /home/sectest/challenge/main.c /tmp/main.c.bk`
  - 考生也可自行备份原始代码文件到本地，通过scp下载
    - 命令`scp -P 22 sectest@127.0.0.1:/home/sectest/challenge/main.c ./main.c.bk`
      - `-P 22`为端口可视情况修改、`127.0.0.1`为ip可视情况修改 
  - 还原代码：
    - 命令`scp -P 22 ./main.c.bk sectest@127.0.0.1:/home/sectest/challenge/main.c`可替换掉环境中修复失败的源码
      - `-P 22`为端口可视情况修改、`127.0.0.1`为ip可视情况修改
    - 或命令`cp /tmp/main.c.bk /home/sectest/challenge/main.c`从tmp目录还原



# 答案提交

<!--通用flag格式说明--> 
**通用flag格式**
格式：flag{xxxxxxxxxxxxxxxx}，`xxxxxxxxxxxxxxxx`为76位随机字符hex值。
验证程序会返回对应漏洞的flag，提交至答题平台即可。

>注意：如果submit长时间不响应结果(大于30s)，可能是在代码中引入了其他打印的字符串或者是改变了代码的功能逻辑，这种情况会视为修复失败。



